%include("_header")
%import x
<main>
    <section>
        <div class="auth-container">
            <h2>{{ 'Update' if property else 'Add' }} Property</h2>    
            <form id="frm_property" class="auth-form" action="/add-property" method="POST" enctype="multipart/form-data">
                <input type="hidden" id="property_id" name="property_id" value="{{ property['item_pk'] if property else '' }}">

                <label for="property_name">Property Title</label>
                <input type="text" id="property_name" name="property_name" value="{{ property['item_name'] if property else '' }}" required>
                
                <label for="property_description">Description</label>
                <input type="text" id="property_description" name="property_description" value="{{ property['item_description'] if property else '' }}" required>                    

                <label for="property_address">Address</label>
                <input type="text" id="property_address" name="property_address" value="{{ address if address else '' }}" required>
                
                <label for="property_price">Price per Night</label>
                <input type="number" id="property_price" name="property_price" value="{{ property['item_price_per_night'] if property else '' }}" required>
                
                <label for="property_rating">Rating</label>
                <input type="number" step=".5" id="property_rating" name="property_rating" min="0" max="5" value="{{ property['item_stars'] if property else '' }}" required>                        

                % if 'property_images' in locals() and property_images and len(property_images) > 0:
                
                    % for image in property_images:                        
                        <div class="image_container">
                            <img src="/images/{{ image['path'] }}" alt="Property Image">
                            <label>
                                <input type="checkbox" name="delete_images" value="{{ image['id'] }}"> Delete
                            </label>
                        </div>
                    % end
                % end
                
                <label for="property_images">Choose images (at least 3):</label>
                <input type="file" id="property_images" name="property_images" accept="image/*" multiple>
                
                %if property:
                    <button class=""
                        mix-data="#frm_property"
                        mix-put="/properties/{{property['item_pk']}}"
                        mix-default="Update Property"
                        mix-await="Please wait ..."
                    >
                        Update
                    </button>
                % else:
                    <button class=""
                        mix-data="#frm_property"
                        mix-post="/properties"
                        mix-default="Save Property"
                        mix-await="Please wait ..."
                    >
                        Save
                    </button>
                % end 
            </form>
        </div>
    </section>
</main>
%include("_footer")

<script>
    function resetForm()
    {
        const form = document.querySelector("#frm_property");
        form.reset();
    }
</script>